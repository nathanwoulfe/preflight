<div ng-controller="preflight.settings.controller as vm" class="preflight preflight-settings">

    <umb-box>
        <umb-box-content>
            <h3 class="bold">Preflight</h3>
            <p>Preflight is a pluggable framework for adding pre-publishing checks to your content.</p>
            <p>Out of the box, Preflight provides plugins for general readability (reading level, sentence length, naughty/nice words), link health and text autocorrect.</p>
            <form novalidate class="form-horizontal" ng-if="vm.isVariant">
                <div class="umb-control-group -last">
                    <div class="control-header">
                        <label class="control-label" for="culture">Culture</label>
                    </div>
                    <div class="controls">
                        <select ng-model="vm.currentVariant" ng-options="v as v.name for v in vm.variants" name="culture" ng-change="vm.getVariantSettings()">
                            <option></option>
                        </select>
                    </div>
                </div>
            </form>
        </umb-box-content>
    </umb-box>
    
    <div ng-if="vm.message && !vm.loading" class="alert alert-info">
        No settings exist for culture: {{ vm.currentVariant.name }}. The settings displayed are copied from the default culture, but will be saved as {{ vm.currentVariant.name }}.
    </div>

    <form novalidate class="form-horizontal" ng-if="!vm.error && vm.tabs">
        <div class="umb-expansion-panel" ng-repeat="tab in vm.tabs">
            <div class="umb-expansion-panel__header" ng-click="tab.open = !tab.open">
                <div>{{ ::tab.name }} <span ng-if="tab.summary">{{ ' - ' + tab.summary }}</span></div>
                <ins class="umb-expansion-panel__expand" ng-class="{ 'icon-navigation-right': !tab.open, 'icon-navigation-down': tab.open }">&nbsp;</ins>
            </div>

            <div class="umb-expansion-panel__content" ng-show="tab.open">
                <div class="umb-control-group mb-20" ng-if="tab.description" ng-bind-html="::tab.description"></div>
                <umb-property data-element="property-{{ ::tab.alias }}" ng-repeat="property in vm.settings | filter: { tab: tab.name } | orderBy: 'order'" property="property">
                    <umb-property-editor model="property"></umb-property-editor>
                </umb-property>
            </div>
        </div> 
        
        <button role="button" class="btn btn-success" ng-click="vm.saveSettings()" ng-if="vm.tabs">
            <localize key="preflight_saveSettings">Save settings</localize>
        </button>
    </form>
    
    <umb-load-indicator ng-if="vm.loading"></umb-load-indicator>
</div>